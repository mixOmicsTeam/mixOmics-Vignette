<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 6 N-Integration | mixOmics vignette</title>
  <meta name="description" content="Vignette for the R package mixOmics" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content=" 6 N-Integration | mixOmics vignette" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Vignette for the R package mixOmics" />
  <meta name="github-repo" content="mixOmicsTeam/mixOmics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 6 N-Integration | mixOmics vignette" />
  
  <meta name="twitter:description" content="Vignette for the R package mixOmics" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_05.html"/>
<link rel="next" href="id_07.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
document.write('<div class="logos"><img src="data:image/jpeg;base64,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" alt="logo" style="position:absolute; top:25px; right:1%; padding:10px;z-index:200;"/></div>')
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="1" data-path="id_01.html"><a href="id_01.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01.html"><a href="id_01.html#id_01:datatypes"><i class="fa fa-check"></i><b>1.1</b> Input data</a></li>
<li class="chapter" data-level="1.2" data-path="id_01.html"><a href="id_01.html#methods"><i class="fa fa-check"></i><b>1.2</b> Methods</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="id_01.html"><a href="id_01.html#id_01:methods"><i class="fa fa-check"></i><b>1.2.1</b> Some background knowledge</a></li>
<li class="chapter" data-level="1.2.2" data-path="id_01.html"><a href="id_01.html#id_01:overview"><i class="fa fa-check"></i><b>1.2.2</b> Overview</a></li>
<li class="chapter" data-level="1.2.3" data-path="id_01.html"><a href="id_01.html#id_01:pubs"><i class="fa fa-check"></i><b>1.2.3</b> Key publications</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="id_01.html"><a href="id_01.html#id_01:outline"><i class="fa fa-check"></i><b>1.3</b> Outline of this Vignette</a></li>
<li class="chapter" data-level="1.4" data-path="id_01.html"><a href="id_01.html#other-methods-not-covered-in-this-vignette"><i class="fa fa-check"></i><b>1.4</b> Other methods not covered in this vignette</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02.html"><a href="id_02.html"><i class="fa fa-check"></i><b>2</b> Let’s get started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02.html"><a href="id_02.html#id_02:install"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="id_02.html"><a href="id_02.html#id_02:load-data"><i class="fa fa-check"></i><b>2.2</b> Load the package</a></li>
<li class="chapter" data-level="2.3" data-path="id_02.html"><a href="id_02.html#upload-data"><i class="fa fa-check"></i><b>2.3</b> Upload data</a></li>
<li class="chapter" data-level="2.4" data-path="id_02.html"><a href="id_02.html#id_02:quick-start"><i class="fa fa-check"></i><b>2.4</b> Quick start in <code>mixOmics</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03.html"><a href="id_03.html"><i class="fa fa-check"></i><b>3</b> PCA on the <code>multidrug</code> study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03.html"><a href="id_03.html#id_03:load-data"><i class="fa fa-check"></i><b>3.1</b> Load the data</a></li>
<li class="chapter" data-level="3.2" data-path="id_03.html"><a href="id_03.html#id_03:pca"><i class="fa fa-check"></i><b>3.2</b> Example: PCA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="id_03.html"><a href="id_03.html#id_03:pca-ncomp"><i class="fa fa-check"></i><b>3.2.1</b> Choose the number of components</a></li>
<li class="chapter" data-level="3.2.2" data-path="id_03.html"><a href="id_03.html#id_03:pca-final"><i class="fa fa-check"></i><b>3.2.2</b> PCA with fewer components</a></li>
<li class="chapter" data-level="3.2.3" data-path="id_03.html"><a href="id_03.html#id_03:pca-vars"><i class="fa fa-check"></i><b>3.2.3</b> Identify the informative variables</a></li>
<li class="chapter" data-level="3.2.4" data-path="id_03.html"><a href="id_03.html#id_03:pca-sample-plot"><i class="fa fa-check"></i><b>3.2.4</b> Sample plots</a></li>
<li class="chapter" data-level="3.2.5" data-path="id_03.html"><a href="id_03.html#id_03:pca-variable-plot"><i class="fa fa-check"></i><b>3.2.5</b> Variable plot: correlation circle plot</a></li>
<li class="chapter" data-level="3.2.6" data-path="id_03.html"><a href="id_03.html#id_03:pca-biplot"><i class="fa fa-check"></i><b>3.2.6</b> Biplot: samples and variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="id_03.html"><a href="id_03.html#id_03:spca"><i class="fa fa-check"></i><b>3.3</b> Example: sparse PCA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="id_03.html"><a href="id_03.html#id_03:spca-vars"><i class="fa fa-check"></i><b>3.3.1</b> Choose the number of variables to select</a></li>
<li class="chapter" data-level="3.3.2" data-path="id_03.html"><a href="id_03.html#id_03:spca-final"><i class="fa fa-check"></i><b>3.3.2</b> Final sparse PCA</a></li>
<li class="chapter" data-level="3.3.3" data-path="id_03.html"><a href="id_03.html#id_03:spca-plots"><i class="fa fa-check"></i><b>3.3.3</b> Sample and variable plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="id_04.html"><a href="id_04.html"><i class="fa fa-check"></i><b>4</b> PLS on the liver toxicity study</a>
<ul>
<li class="chapter" data-level="4.1" data-path="id_04.html"><a href="id_04.html#id_04:load-data"><i class="fa fa-check"></i><b>4.1</b> Load the data</a></li>
<li class="chapter" data-level="4.2" data-path="id_04.html"><a href="id_04.html#id_04:spls1"><i class="fa fa-check"></i><b>4.2</b> Example: sPLS1 regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="id_04.html"><a href="id_04.html#id_04:spls1-ncomp"><i class="fa fa-check"></i><b>4.2.1</b> Number of dimensions using the <span class="math inline">\(Q^2\)</span> criterion</a></li>
<li class="chapter" data-level="4.2.2" data-path="id_04.html"><a href="id_04.html#id_04:spls1-tuning"><i class="fa fa-check"></i><b>4.2.2</b> Number of variables to select in <span class="math inline">\(\boldsymbol X\)</span></a></li>
<li class="chapter" data-level="4.2.3" data-path="id_04.html"><a href="id_04.html#id_04:spls1-final"><i class="fa fa-check"></i><b>4.2.3</b> Final sPLS1 model</a></li>
<li class="chapter" data-level="4.2.4" data-path="id_04.html"><a href="id_04.html#id_04:spls1-sample-plots"><i class="fa fa-check"></i><b>4.2.4</b> Sample plots</a></li>
<li class="chapter" data-level="4.2.5" data-path="id_04.html"><a href="id_04.html#id_04:spls1-perf"><i class="fa fa-check"></i><b>4.2.5</b> Performance assessment of sPLS1</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="id_04.html"><a href="id_04.html#id_04:spls2"><i class="fa fa-check"></i><b>4.3</b> Example: PLS2 regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="id_04.html"><a href="id_04.html#id_04:spls2-ncomp"><i class="fa fa-check"></i><b>4.3.1</b> Number of dimensions using the <span class="math inline">\(Q^2\)</span> criterion</a></li>
<li class="chapter" data-level="4.3.2" data-path="id_04.html"><a href="id_04.html#id_04:spls2-tuning"><i class="fa fa-check"></i><b>4.3.2</b> Number of variables to select in both <span class="math inline">\(\boldsymbol X\)</span> and <span class="math inline">\(\boldsymbol Y\)</span></a></li>
<li class="chapter" data-level="4.3.3" data-path="id_04.html"><a href="id_04.html#id_04:spls2-final"><i class="fa fa-check"></i><b>4.3.3</b> Final sPLS2 model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="id_05.html"><a href="id_05.html"><i class="fa fa-check"></i><b>5</b> PLS-DA on the SRBCT case study</a>
<ul>
<li class="chapter" data-level="5.1" data-path="id_05.html"><a href="id_05.html#id_05:load-data"><i class="fa fa-check"></i><b>5.1</b> Load the data</a></li>
<li class="chapter" data-level="5.2" data-path="id_05.html"><a href="id_05.html#id_05:plsda"><i class="fa fa-check"></i><b>5.2</b> Example: PLS-DA</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="id_05.html"><a href="id_05.html#id_05:plsda-pca"><i class="fa fa-check"></i><b>5.2.1</b> Initial exploration with PCA</a></li>
<li class="chapter" data-level="5.2.2" data-path="id_05.html"><a href="id_05.html#id_05:plsda-ncomp"><i class="fa fa-check"></i><b>5.2.2</b> Number of components in PLS-DA</a></li>
<li class="chapter" data-level="5.2.3" data-path="id_05.html"><a href="id_05.html#id_05:plsda-final"><i class="fa fa-check"></i><b>5.2.3</b> Final PLS-DA model</a></li>
<li class="chapter" data-level="5.2.4" data-path="id_05.html"><a href="id_05.html#id_05:plsda-perf"><i class="fa fa-check"></i><b>5.2.4</b> Classification performance</a></li>
<li class="chapter" data-level="5.2.5" data-path="id_05.html"><a href="id_05.html#id_05:plsda-bgp"><i class="fa fa-check"></i><b>5.2.5</b> Background prediction</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="id_05.html"><a href="id_05.html#id_05:splsda"><i class="fa fa-check"></i><b>5.3</b> Example: sPLS-DA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="id_05.html"><a href="id_05.html#id_05:splsda-keepX"><i class="fa fa-check"></i><b>5.3.1</b> Number of variables to select</a></li>
<li class="chapter" data-level="5.3.2" data-path="id_05.html"><a href="id_05.html#final-splsda-perf"><i class="fa fa-check"></i><b>5.3.2</b> Final model and performance</a></li>
<li class="chapter" data-level="5.3.3" data-path="id_05.html"><a href="id_05.html#id_05:stab"><i class="fa fa-check"></i><b>5.3.3</b> Variable selection and stability</a></li>
<li class="chapter" data-level="5.3.4" data-path="id_05.html"><a href="id_05.html#sample-visualisation"><i class="fa fa-check"></i><b>5.3.4</b> Sample visualisation</a></li>
<li class="chapter" data-level="5.3.5" data-path="id_05.html"><a href="id_05.html#id_05:varplot"><i class="fa fa-check"></i><b>5.3.5</b> Variable visualisation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="id_05.html"><a href="id_05.html#id_05:splsda-predict"><i class="fa fa-check"></i><b>5.4</b> Take a detour: prediction</a></li>
<li class="chapter" data-level="5.5" data-path="id_05.html"><a href="id_05.html#id_05:splsda-auroc"><i class="fa fa-check"></i><b>5.5</b> AUROC outputs complement performance evaluation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_06.html"><a href="id_06.html"><i class="fa fa-check"></i><b>6</b> N-Integration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="id_06.html"><a href="id_06.html#id_06:diablo"><i class="fa fa-check"></i><b>6.1</b> Block sPLS-DA on the TCGA case study</a></li>
<li class="chapter" data-level="6.2" data-path="id_06.html"><a href="id_06.html#id_06:diablo-load-data"><i class="fa fa-check"></i><b>6.2</b> Load the data</a></li>
<li class="chapter" data-level="6.3" data-path="id_06.html"><a href="id_06.html#id_06:diablo-params"><i class="fa fa-check"></i><b>6.3</b> Parameter choice</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="id_06.html"><a href="id_06.html#id_06:diablo-design"><i class="fa fa-check"></i><b>6.3.1</b> Design matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="id_06.html"><a href="id_06.html#id_06:diablo-ncomp"><i class="fa fa-check"></i><b>6.3.2</b> Number of components</a></li>
<li class="chapter" data-level="6.3.3" data-path="id_06.html"><a href="id_06.html#id_06:diablo-tuning"><i class="fa fa-check"></i><b>6.3.3</b> Number of variables to select</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="id_06.html"><a href="id_06.html#id_06:diablo-final"><i class="fa fa-check"></i><b>6.4</b> Final model</a></li>
<li class="chapter" data-level="6.5" data-path="id_06.html"><a href="id_06.html#id_06:diablo-sample-plots"><i class="fa fa-check"></i><b>6.5</b> Sample plots</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="id_06.html"><a href="id_06.html#plotdiablo"><i class="fa fa-check"></i><b>6.5.1</b> <code>plotDiablo</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="id_06.html"><a href="id_06.html#plotindiv"><i class="fa fa-check"></i><b>6.5.2</b> <code>plotIndiv</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="id_06.html"><a href="id_06.html#plotarrow"><i class="fa fa-check"></i><b>6.5.3</b> <code>plotArrow</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="id_06.html"><a href="id_06.html#id_06:diablo-variable-plots"><i class="fa fa-check"></i><b>6.6</b> Variable plots</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="id_06.html"><a href="id_06.html#plotvar"><i class="fa fa-check"></i><b>6.6.1</b> <code>plotVar</code></a></li>
<li class="chapter" data-level="6.6.2" data-path="id_06.html"><a href="id_06.html#circosplot"><i class="fa fa-check"></i><b>6.6.2</b> <code>circosPlot</code></a></li>
<li class="chapter" data-level="6.6.3" data-path="id_06.html"><a href="id_06.html#network"><i class="fa fa-check"></i><b>6.6.3</b> <code>network</code></a></li>
<li class="chapter" data-level="6.6.4" data-path="id_06.html"><a href="id_06.html#plotloadings"><i class="fa fa-check"></i><b>6.6.4</b> <code>plotLoadings</code></a></li>
<li class="chapter" data-level="6.6.5" data-path="id_06.html"><a href="id_06.html#cimdiablo"><i class="fa fa-check"></i><b>6.6.5</b> <code>cimDiablo</code></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="id_06.html"><a href="id_06.html#id_06:diablo-perf"><i class="fa fa-check"></i><b>6.7</b> Model performance and prediction</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="id_07.html"><a href="id_07.html"><i class="fa fa-check"></i><b>7</b> P-Integration</a>
<ul>
<li class="chapter" data-level="7.1" data-path="id_07.html"><a href="id_07.html#id_07:mint"><i class="fa fa-check"></i><b>7.1</b> MINT on the stem cell case study</a></li>
<li class="chapter" data-level="7.2" data-path="id_07.html"><a href="id_07.html#id_07:load-data"><i class="fa fa-check"></i><b>7.2</b> Load the data</a></li>
<li class="chapter" data-level="7.3" data-path="id_07.html"><a href="id_07.html#id_07:plsda"><i class="fa fa-check"></i><b>7.3</b> Example: MINT PLS-DA</a></li>
<li class="chapter" data-level="7.4" data-path="id_07.html"><a href="id_07.html#id_07:splsda"><i class="fa fa-check"></i><b>7.4</b> Example: MINT sPLS-DA</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="id_07.html"><a href="id_07.html#id_07:splsda-tuning"><i class="fa fa-check"></i><b>7.4.1</b> Number of variables to select</a></li>
<li class="chapter" data-level="7.4.2" data-path="id_07.html"><a href="id_07.html#id_07:splsda-final"><i class="fa fa-check"></i><b>7.4.2</b> Final MINT sPLS-DA model</a></li>
<li class="chapter" data-level="7.4.3" data-path="id_07.html"><a href="id_07.html#id_07:splsda-sample-plots"><i class="fa fa-check"></i><b>7.4.3</b> Sample plots</a></li>
<li class="chapter" data-level="7.4.4" data-path="id_07.html"><a href="id_07.html#id_07:splsda-variable-plots"><i class="fa fa-check"></i><b>7.4.4</b> Variable plots</a></li>
<li class="chapter" data-level="7.4.5" data-path="id_07.html"><a href="id_07.html#id_07:splsda-perf"><i class="fa fa-check"></i><b>7.4.5</b> Classification performance</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="id_07.html"><a href="id_07.html#id_07:splsda-auroc"><i class="fa fa-check"></i><b>7.5</b> Take a detour</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="id_07.html"><a href="id_07.html#auc"><i class="fa fa-check"></i><b>7.5.1</b> AUC</a></li>
<li class="chapter" data-level="7.5.2" data-path="id_07.html"><a href="id_07.html#id_07:splsda-predict"><i class="fa fa-check"></i><b>7.5.2</b> Prediction on an external study</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="id_08.html"><a href="id_08.html"><i class="fa fa-check"></i><b>8</b> Session Information</a>
<ul>
<li class="chapter" data-level="8.1" data-path="id_08.html"><a href="id_08.html#id_08:mixomics-ver"><i class="fa fa-check"></i><b>8.1</b> mixOmics version</a></li>
<li class="chapter" data-level="8.2" data-path="id_08.html"><a href="id_08.html#id_08:session-info"><i class="fa fa-check"></i><b>8.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">mixOmics vignette</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_06" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number"> 6</span> N-Integration<a href="id_06.html#id_06" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>N-Integration is the framework of having multiple datasets which measure different aspects of the same samples. For example, you may have transcriptomic, genetic and proteomic data for the same set of cells. N-integrative methods are built to use the information in all three of these dataframes simultaenously.</p>
<p>DIABLO is a novel <code>mixOmics</code> framework for the integration of multiple data sets while explaining their relationship with a categorical outcome variable. DIABLO stands for <strong>D</strong>ata <strong>I</strong>ntegration <strong>A</strong>nalysis for <strong>B</strong>iomarker discovery using <strong>L</strong>atent variable approaches for <strong>O</strong>mics studies. It can also be referred to as Multiblock (s)PLS-DA.</p>
<div id="id_06:diablo" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Block sPLS-DA on the TCGA case study<a href="id_06.html#id_06:diablo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Human breast cancer is a heterogeneous disease in terms of molecular alterations, cellular composition, and clinical outcome. Breast tumours can be classified into several subtypes, according to their levels of mRNA expression <span class="citation">(<a href="references.html#ref-Sor01" role="doc-biblioref">Sørlie et al. 2001</a>)</span>. Here we consider a subset of data generated by The Cancer Genome Atlas Network <span class="citation">(<a href="references.html#ref-TCGA12" role="doc-biblioref">Cancer Genome Atlas Network et al. 2012</a>)</span>. For the package, data were normalised, and then drastically prefiltered for illustrative purposes.</p>
<p>The data were divided into a <em>training set</em> with a subset of 150 samples from the mRNA, miRNA and proteomics data, and a <em>test set</em> including 70 samples, but only with mRNA and miRNA data (the proteomics data are missing). The aim of this integrative analysis is to identify a highly correlated multi-omics signature discriminating the breast cancer subtypes Basal, Her2 and LumA.</p>
<p>The <code>breast.TCGA</code> (more details can be found in <code>?breast.TCGA</code>) is a list containing training and test sets of omics data <code>data.train</code> and <code>data.test</code> which include:</p>
<ul>
<li><code>$miRNA</code>: A data frame with 150 (70) rows and 184 columns in the training (test) data set for the miRNA expression levels,</li>
<li><code>$mRNA</code>: A data frame with 150 (70) rows and 520 columns in the training (test) data set for the mRNA expression levels,</li>
<li><code>$protein</code>: A data frame with 150 rows and 142 columns in the training data set for the protein abundance (there are no proteomics in the test set),</li>
<li><code>$subtype</code>: A factor indicating the breast cancer subtypes in the training (for 150 samples) and test sets (for 70 samples).</li>
</ul>
<p>This case study covers an interesting scenario where one omic data set is missing in the test set, but because the method generates a set of components per training data set, we can still assess the prediction or performance evaluation using majority or weighted prediction vote.</p>
</div>
<div id="id_06:diablo-load-data" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Load the data<a href="id_06.html#id_06:diablo-load-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To illustrate the multiblock sPLS-DA approach, we will integrate the expression levels of miRNA, mRNA and the abundance of proteins while discriminating the subtypes of breast cancer, then predict the subtypes of the samples in the test set.</p>
<p>The input data is first set up as a list of <span class="math inline">\(Q\)</span> matrices <span class="math inline">\(\boldsymbol X_1, \dots, \boldsymbol X_Q\)</span> and a factor indicating the class membership of each sample <span class="math inline">\(\boldsymbol Y\)</span>. Each data frame in <span class="math inline">\(\boldsymbol X\)</span> <em>should be named</em> as we will match these names with the <code>keepX</code> parameter for the sparse method.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="id_06.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mixOmics)</span>
<span id="cb139-2"><a href="id_06.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(breast.TCGA)</span>
<span id="cb139-3"><a href="id_06.html#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="id_06.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract training data and name each data frame</span></span>
<span id="cb139-5"><a href="id_06.html#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Store as list</span></span>
<span id="cb139-6"><a href="id_06.html#cb139-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mRNA =</span> breast.TCGA<span class="sc">$</span>data.train<span class="sc">$</span>mrna, </span>
<span id="cb139-7"><a href="id_06.html#cb139-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">miRNA =</span> breast.TCGA<span class="sc">$</span>data.train<span class="sc">$</span>mirna, </span>
<span id="cb139-8"><a href="id_06.html#cb139-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">protein =</span> breast.TCGA<span class="sc">$</span>data.train<span class="sc">$</span>protein)</span>
<span id="cb139-9"><a href="id_06.html#cb139-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-10"><a href="id_06.html#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome</span></span>
<span id="cb139-11"><a href="id_06.html#cb139-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> breast.TCGA<span class="sc">$</span>data.train<span class="sc">$</span>subtype</span>
<span id="cb139-12"><a href="id_06.html#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Y)</span></code></pre></div>
<pre><code>## Basal  Her2  LumA 
##    45    30    75</code></pre>
</div>
<div id="id_06:diablo-params" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Parameter choice<a href="id_06.html#id_06:diablo-params" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="id_06:diablo-design" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Design matrix<a href="id_06.html#id_06:diablo-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The choice of the design can be motivated by different aspects, including:</p>
<ul>
<li><p>Biological apriori knowledge: Should we expect <code>mRNA</code> and <code>miRNA</code> to be highly correlated?</p></li>
<li><p>Analytical aims: As further developed in <span class="citation">Singh et al. (<a href="references.html#ref-Sin19" role="doc-biblioref">2019</a>)</span>, a compromise needs to be achieved between a classification and prediction task, and extracting the correlation structure of the data sets. A full design with weights = 1 will favour the latter, but at the expense of classification accuracy, whereas a design with small weights will lead to a highly predictive signature. This pertains to the complexity of the analytical task involved as several constraints are included in the optimisation procedure. For example, here we choose a 0.1 weighted model as we are interested in predicting test samples later in this case study.</p></li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="id_06.html#cb141-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fl">0.1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(X), <span class="at">nrow =</span> <span class="fu">length</span>(X), </span>
<span id="cb141-2"><a href="id_06.html#cb141-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">names</span>(X), <span class="fu">names</span>(X)))</span>
<span id="cb141-3"><a href="id_06.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(design) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb141-4"><a href="id_06.html#cb141-4" aria-hidden="true" tabindex="-1"></a>design </span></code></pre></div>
<pre><code>##         mRNA miRNA protein
## mRNA     0.0   0.1     0.1
## miRNA    0.1   0.0     0.1
## protein  0.1   0.1     0.0</code></pre>
<p>Note however that even with this design, we will still unravel a correlated signature as we require all data sets to explain the same outcome <span class="math inline">\(\boldsymbol y\)</span>, as well as maximising pairs of covariances between data sets.</p>
<ul>
<li>Data-driven option: we could perform regression analyses with PLS to further understand the correlation between data sets. Here for example, we run PLS with one component and calculate the cross-correlations between components associated to each data set:</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="id_06.html#cb143-1" aria-hidden="true" tabindex="-1"></a>res1.pls.tcga <span class="ot">&lt;-</span> <span class="fu">pls</span>(X<span class="sc">$</span>mRNA, X<span class="sc">$</span>protein, <span class="at">ncomp =</span> <span class="dv">1</span>)</span>
<span id="cb143-2"><a href="id_06.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(res1.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>X, res1.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>Y)</span>
<span id="cb143-3"><a href="id_06.html#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="id_06.html#cb143-4" aria-hidden="true" tabindex="-1"></a>res2.pls.tcga <span class="ot">&lt;-</span> <span class="fu">pls</span>(X<span class="sc">$</span>mRNA, X<span class="sc">$</span>miRNA, <span class="at">ncomp =</span> <span class="dv">1</span>)</span>
<span id="cb143-5"><a href="id_06.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(res2.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>X, res2.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>Y)</span>
<span id="cb143-6"><a href="id_06.html#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="id_06.html#cb143-7" aria-hidden="true" tabindex="-1"></a>res3.pls.tcga <span class="ot">&lt;-</span> <span class="fu">pls</span>(X<span class="sc">$</span>protein, X<span class="sc">$</span>miRNA, <span class="at">ncomp =</span> <span class="dv">1</span>)</span>
<span id="cb143-8"><a href="id_06.html#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(res3.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>X, res3.pls.tcga<span class="sc">$</span>variates<span class="sc">$</span>Y)</span></code></pre></div>
<pre><code>##           comp1
## comp1 0.9031761
##           comp1
## comp1 0.8456299
##           comp1
## comp1 0.7982008</code></pre>
<p>The data sets taken in a pairwise manner are highly correlated, indicating that a design with weights <span class="math inline">\(\sim 0.8 - 0.9\)</span> could be chosen.</p>
</div>
<div id="id_06:diablo-ncomp" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Number of components<a href="id_06.html#id_06:diablo-ncomp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As in the PLS-DA framework presented in Module 3, we first fit a <code>block.plsda</code> model without variable selection to assess the global performance of the model and choose the number of components. We run <code>perf()</code> with 10-fold cross validation repeated 10 times for up to 5 components and with our specified design matrix. Similar to PLS-DA, we obtain the performance of the model with respect to the different prediction distances (Figure <a href="id_06.html#fig:06-ncomp">6.1</a>):</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="id_06.html#cb145-1" aria-hidden="true" tabindex="-1"></a>diablo.tcga <span class="ot">&lt;-</span> <span class="fu">block.plsda</span>(X, Y, <span class="at">ncomp =</span> <span class="dv">5</span>, <span class="at">design =</span> design)</span>
<span id="cb145-2"><a href="id_06.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="id_06.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility, remove for your analyses</span></span>
<span id="cb145-4"><a href="id_06.html#cb145-4" aria-hidden="true" tabindex="-1"></a>perf.diablo.tcga <span class="ot">=</span> <span class="fu">perf</span>(diablo.tcga, <span class="at">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="at">folds =</span> <span class="dv">10</span>, <span class="at">nrepeat =</span> <span class="dv">10</span>)</span>
<span id="cb145-5"><a href="id_06.html#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="id_06.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co">#perf.diablo.tcga$error.rate  # Lists the different types of error rates</span></span>
<span id="cb145-7"><a href="id_06.html#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="id_06.html#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of the error rates based on weighted vote</span></span>
<span id="cb145-9"><a href="id_06.html#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf.diablo.tcga)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-ncomp"></span>
<img src="Figures/N-Integration/06-ncomp-1.png" alt="Choosing the number of components in block.plsda using perf() with 10 x 10-fold CV function in the breast.TCGA study. Classification error rates (overall and balanced, see Module 2) are represented on the y-axis with respect to the number of components on the x-axis for each prediction distance presented in PLS-DA in Seciton 3.4 and detailed in Extra reading material 3 from Module 3. Bars show the standard deviation across the 10 repeated folds. The plot shows that the error rate reaches a minimum from 2 to 3 dimensions." width="70%" />
<p class="caption">
Figure 6.1: <strong>Choosing the number of components in <code>block.plsda</code> using <code>perf()</code> with 10 x 10-fold CV function in the <code>breast.TCGA</code> study</strong>. Classification error rates (overall and balanced, see Module 2) are represented on the y-axis with respect to the number of components on the x-axis for each prediction distance presented in PLS-DA in Seciton 3.4 and detailed in Extra reading material 3 from Module 3. Bars show the standard deviation across the 10 repeated folds. The plot shows that the error rate reaches a minimum from 2 to 3 dimensions.
</p>
</div>

<p>The performance plot indicates that two components should be sufficient in the final model, and that the centroids distance might lead to better prediction. A balanced error rate (BER) should be considered for further analysis.</p>
<p>The following outputs the optimal number of components according to the prediction distance and type of error rate (overall or balanced), as well as a prediction weighting scheme illustrated further below.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="id_06.html#cb146-1" aria-hidden="true" tabindex="-1"></a>perf.diablo.tcga<span class="sc">$</span>choice.ncomp<span class="sc">$</span>WeightedVote</span></code></pre></div>
<pre><code>##             max.dist centroids.dist mahalanobis.dist
## Overall.ER         3              2                3
## Overall.BER        3              2                3</code></pre>
<p>Thus, here we choose our final <code>ncomp</code> value:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="id_06.html#cb148-1" aria-hidden="true" tabindex="-1"></a>ncomp <span class="ot">&lt;-</span> perf.diablo.tcga<span class="sc">$</span>choice.ncomp<span class="sc">$</span>WeightedVote[<span class="st">&quot;Overall.BER&quot;</span>, <span class="st">&quot;centroids.dist&quot;</span>]</span></code></pre></div>
</div>
<div id="id_06:diablo-tuning" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Number of variables to select<a href="id_06.html#id_06:diablo-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We then choose the optimal number of variables to select in each data set using the <code>tune.block.splsda</code> function. The function <code>tune()</code> is run with 10-fold cross validation, but repeated only once (<code>nrepeat = 1</code>) for illustrative and computational reasons here. For a thorough tuning process, we advise increasing the <code>nrepeat</code> argument to 10-50, or more.</p>
<p>We choose a <code>keepX</code> grid that is relatively fine at the start, then coarse. If the data sets are easy to classify, the tuning step may indicate the smallest number of variables to separate the sample groups. Hence, we start our grid at the value <code>5</code> to avoid a too small signature that may preclude biological interpretation.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="id_06.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chunk takes about 2 min to run</span></span>
<span id="cb149-2"><a href="id_06.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb149-3"><a href="id_06.html#cb149-3" aria-hidden="true" tabindex="-1"></a>test.keepX <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mRNA =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>, <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">5</span>)),</span>
<span id="cb149-4"><a href="id_06.html#cb149-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">miRNA =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>, <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">2</span>)),</span>
<span id="cb149-5"><a href="id_06.html#cb149-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">proteomics =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">5</span>)))</span>
<span id="cb149-6"><a href="id_06.html#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="id_06.html#cb149-7" aria-hidden="true" tabindex="-1"></a>tune.diablo.tcga <span class="ot">&lt;-</span> <span class="fu">tune.block.splsda</span>(X, Y, <span class="at">ncomp =</span> <span class="dv">2</span>, </span>
<span id="cb149-8"><a href="id_06.html#cb149-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">test.keepX =</span> test.keepX, <span class="at">design =</span> design,</span>
<span id="cb149-9"><a href="id_06.html#cb149-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="at">folds =</span> <span class="dv">10</span>, <span class="at">nrepeat =</span> <span class="dv">1</span>, </span>
<span id="cb149-10"><a href="id_06.html#cb149-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">SnowParam</span>(<span class="at">workers =</span> <span class="dv">2</span>),</span>
<span id="cb149-11"><a href="id_06.html#cb149-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dist =</span> <span class="st">&quot;centroids.dist&quot;</span>)</span>
<span id="cb149-12"><a href="id_06.html#cb149-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-13"><a href="id_06.html#cb149-13" aria-hidden="true" tabindex="-1"></a>list.keepX <span class="ot">&lt;-</span> tune.diablo.tcga<span class="sc">$</span>choice.keepX</span></code></pre></div>
<p>Note:</p>
<ul>
<li><em>For fast computation, we can use parallel computing here - this option is also enabled on a laptop or workstation, see <code>?tune.block.splsda</code>.</em></li>
</ul>
<p>The number of features to select on each component is returned and stored for the final model:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="id_06.html#cb150-1" aria-hidden="true" tabindex="-1"></a>list.keepX</span></code></pre></div>
<pre><code>## $mRNA
## [1]  8 25
## 
## $miRNA
## [1] 14  5
## 
## $protein
## [1] 10  5</code></pre>
<p>Note:</p>
<ul>
<li><em>You can skip any of the tuning steps above, and hard code your chosen <code>ncomp</code> and <code>keepX</code> parameters (as a list for the latter, as shown below).</em></li>
</ul>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="id_06.html#cb152-1" aria-hidden="true" tabindex="-1"></a>list.keepX <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">mRNA =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">25</span>), <span class="at">miRNA =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">5</span>), <span class="at">protein =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span></code></pre></div>
</div>
</div>
<div id="id_06:diablo-final" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Final model<a href="id_06.html#id_06:diablo-final" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The final multiblock sPLS-DA model includes the tuned parameters and is run as:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="id_06.html#cb153-1" aria-hidden="true" tabindex="-1"></a>diablo.tcga <span class="ot">&lt;-</span> <span class="fu">block.splsda</span>(X, Y, <span class="at">ncomp =</span> ncomp, </span>
<span id="cb153-2"><a href="id_06.html#cb153-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">keepX =</span> list.keepX, <span class="at">design =</span> design)</span></code></pre></div>
<pre><code>## Design matrix has changed to include Y; each block will be
##             linked to Y.</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="id_06.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#06.tcga   # Lists the different functions of interest related to that object</span></span></code></pre></div>
<p>A warning message informs us that the outcome <span class="math inline">\(\boldsymbol Y\)</span> has been included automatically in the design, so that the covariance between each block’s component and the outcome is maximised, as shown in the final design output:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="id_06.html#cb156-1" aria-hidden="true" tabindex="-1"></a>diablo.tcga<span class="sc">$</span>design</span></code></pre></div>
<pre><code>##         mRNA miRNA protein Y
## mRNA     0.0   0.1     0.1 1
## miRNA    0.1   0.0     0.1 1
## protein  0.1   0.1     0.0 1
## Y        1.0   1.0     1.0 0</code></pre>
<p>The selected variables can be extracted with the function <code>selectVar()</code>, for example in the mRNA block, along with their loading weights (not output here):</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="id_06.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mRNA variables selected on component 1</span></span>
<span id="cb158-2"><a href="id_06.html#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">selectVar</span>(diablo.tcga, <span class="at">block =</span> <span class="st">&#39;mRNA&#39;</span>, <span class="at">comp =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><em>Note:</em></p>
<ul>
<li><em>The stability of the selected variables can be extracted from the <code>perf()</code> function, similar to the example given in the PLS-DA analysis (Module 3).</em></li>
</ul>
</div>
<div id="id_06:diablo-sample-plots" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Sample plots<a href="id_06.html#id_06:diablo-sample-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="plotdiablo" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> <code>plotDiablo</code><a href="id_06.html#plotdiablo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>plotDiablo()</code> is a diagnostic plot to check whether the correlations between components from each data set were maximised as specified in the design matrix. We specify the dimension to be assessed with the <code>ncomp</code> argument (Figure <a href="id_06.html#fig:06-diablo-plot">6.2</a>).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="id_06.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDiablo</span>(diablo.tcga, <span class="at">ncomp =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-diablo-plot"></span>
<img src="Figures/N-Integration/06-diablo-plot-1.png" alt="Diagnostic plot from multiblock sPLS-DA applied on the breast.TCGA study. Samples are represented based on the specified component (here ncomp = 1) for each data set (mRNA, miRNA and protein). Samples are coloured by breast cancer subtype (Basal, Her2 and LumA) and 95% confidence ellipse plots are represented. The bottom left numbers indicate the correlation coefficients between the first components from each data set. In this example, mRNA expression and protein concentration are highly correlated on the first dimension." width="70%" />
<p class="caption">
Figure 6.2: <strong>Diagnostic plot from multiblock sPLS-DA applied on the <code>breast.TCGA</code> study.</strong> Samples are represented based on the specified component (here <code>ncomp = 1</code>) for each data set (mRNA, miRNA and protein). Samples are coloured by breast cancer subtype (<span style="color: #388ECC;">Basal</span>, <span style="color: #F68B33;">Her2</span> and <span style="color: #585858;">LumA</span>) and 95% confidence ellipse plots are represented. The bottom left numbers indicate the correlation coefficients between the first components from each data set. In this example, mRNA expression and protein concentration are highly correlated on the first dimension.
</p>
</div>

<p>The plot indicates that the first components from all data sets are highly correlated. The colours and ellipses represent the sample subtypes and indicate the discriminative power of each component to separate the different tumour subtypes. Thus, multiblock sPLS-DA is able to extract a strong correlation structure between data sets, as well as discriminate the breast cancer subtypes on the first component.</p>
</div>
<div id="plotindiv" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> <code>plotIndiv</code><a href="id_06.html#plotindiv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sample plot with the <code>plotIndiv()</code> function projects each sample into the space spanned by the components from <em>each</em> block, resulting in a series of graphs corresponding to each data set (Figure <a href="id_06.html#fig:06-sample-plot">6.3</a>). The optional argument <code>blocks</code> can output a specific data set. Ellipse plots are also available (argument <code>ellipse = TRUE</code>).</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="id_06.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotIndiv</span>(diablo.tcga, <span class="at">ind.names =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb160-2"><a href="id_06.html#cb160-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-sample-plot"></span>
<img src="Figures/N-Integration/06-sample-plot-1.png" alt="Sample plot from multiblock sPLS-DA performed on the breast.TCGA study. The samples are plotted according to their scores on the first 2 components for each data set. Samples are coloured by cancer subtype and are classified into three classes: Basal, Her2 and LumA. The plot shows the degree of agreement between the different data sets and the discriminative ability of each data set." width="70%" />
<p class="caption">
Figure 6.3: <strong>Sample plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The samples are plotted according to their scores on the first 2 components for each data set. Samples are coloured by cancer subtype and are classified into three classes: <span style="color: #388ECC;">Basal</span>, <span style="color: #F68B33;">Her2</span> and <span style="color: #585858;">LumA</span>. The plot shows the degree of agreement between the different data sets and the discriminative ability of each data set.
</p>
</div>

<p>This type of graphic allows us to better understand the information extracted from each data set and its discriminative ability. Here we can see that the <span style="color: #585858;">LumA</span> group can be difficult to classify in the miRNA data.</p>
<p>Note:</p>
<ul>
<li><em>Additional variants include the argument <code>block = 'average'</code> that averages the components from all blocks to produce a single plot. The argument <code>block='weighted.average'</code> is a weighted average of the components according to their correlation with the components associated with the outcome</em>.</li>
</ul>
</div>
<div id="plotarrow" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> <code>plotArrow</code><a href="id_06.html#plotarrow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the arrow plot in Figure <a href="id_06.html#fig:06-arrow-plot">6.4</a>, the start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of that same sample but in each block. Such graphics highlight the agreement between all data sets at the sample level when modelled with multiblock sPLS-DA.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="id_06.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotArrow</span>(diablo.tcga, <span class="at">ind.names =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb161-2"><a href="id_06.html#cb161-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-arrow-plot"></span>
<img src="Figures/N-Integration/06-arrow-plot-1.png" alt="Arrow plot from multiblock sPLS-DA performed on the breast.TCGA study. The samples are projected into the space spanned by the first two components for each data set then overlaid across data sets. The start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of the same sample in each block. Arrows further from their centroid indicate some disagreement between the data sets. Samples are coloured by cancer subtype (Basal, Her2 and LumA)." width="70%" />
<p class="caption">
Figure 6.4: <strong>Arrow plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The samples are projected into the space spanned by the first two components for each data set then overlaid across data sets. The start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of the same sample in each block. Arrows further from their centroid indicate some disagreement between the data sets. Samples are coloured by cancer subtype (<span style="color: #388ECC;">Basal</span>, <span style="color: #F68B33;">Her2</span> and <span style="color: #585858;">LumA</span>).
</p>
</div>

<p>This plot shows that globally, the discrimination of all breast cancer subtypes can be extracted from all data sets, however, there are some dissimilarities at the samples level across data sets (the common information cannot be extracted in the same way across data sets).</p>
</div>
</div>
<div id="id_06:diablo-variable-plots" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Variable plots<a href="id_06.html#id_06:diablo-variable-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The visualisation of the selected variables is crucial to mine their associations in multiblock sPLS-DA. Here we revisit existing outputs presented in Module 2 with further developments for multiple data set integration. All the plots presented provide complementary information for interpreting the results.</p>
<div id="plotvar" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> <code>plotVar</code><a href="id_06.html#plotvar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The correlation circle plot highlights the contribution of each selected variable to each component. Important variables should be close to the large circle (see Module 2). Here, only the variables selected on components 1 and 2 are depicted (across all blocks), see Figure <a href="id_06.html#fig:06-correlation-plot">6.5</a>. Clusters of points indicate a strong correlation between variables. For better visibility we chose to hide the variable names.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="id_06.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVar</span>(diablo.tcga, <span class="at">var.names =</span> <span class="cn">FALSE</span>, <span class="at">style =</span> <span class="st">&#39;graphics&#39;</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb162-2"><a href="id_06.html#cb162-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">15</span>), <span class="at">cex =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb162-3"><a href="id_06.html#cb162-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</span>
<span id="cb162-4"><a href="id_06.html#cb162-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-correlation-plot"></span>
<img src="Figures/N-Integration/06-correlation-plot-1.png" alt="Correlation circle plot from multiblock sPLS-DA performed on the breast.TCGA study. The variable coordinates are defined according to their correlation with the first and second components for each data set. Variable types are indicated with different symbols and colours, and are overlaid on the same plot. The plot highlights the potential associations within and between different variable types when they are important in defining their own component." width="70%" />
<p class="caption">
Figure 6.5: <strong>Correlation circle plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The variable coordinates are defined according to their correlation with the first and second components for each data set. Variable types are indicated with different symbols and colours, and are overlaid on the same plot. The plot highlights the potential associations within and between different variable types when they are important in defining their own component.
</p>
</div>

<p>The correlation circle plot shows some positive correlations (between selected <span style="color: black;">miRNA</span> and <span style="color: black;">proteins</span>, between selected <span style="color: black;">proteins</span> and <span style="color: black;">mRNA</span>) and negative correlations between <span style="color: black;">mRNA</span>and <span style="color: black;">miRNA</span> on component 1. The correlation structure is less obvious on component 2, but we observe some key selected features (<span style="color: black;">proteins</span> and <span style="color: black;">miRNA</span>) that seem to highly contribute to component 2.</p>
<p>Note:</p>
<ul>
<li><p><em>These results can be further investigated by showing the variable names on this plot (or extracting their coordinates available from the plot saved into an object, see <code>?plotVar</code>), and looking at various outputs from <code>selectVar()</code> and <code>plotLoadings()</code>.</em></p></li>
<li><p><em>You can choose to only show specific variable type names, e.g. <code>var.names = c(FALSE, FALSE, TRUE)</code> (where each argument is assigned to a data set in <span class="math inline">\(\boldsymbol X\)</span>). Here for example, the protein names only would be output.</em></p></li>
</ul>
</div>
<div id="circosplot" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> <code>circosPlot</code><a href="id_06.html#circosplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The circos plot represents the correlations between variables of different types, represented on the side quadrants. Several display options are possible, to show within and between connections between blocks, and expression levels of each variable according to each class (argument <code>line = TRUE</code>). The circos plot is built based on a similarity matrix, which was extended to the case of multiple data sets from <span class="citation">González et al. (<a href="references.html#ref-Gon12" role="doc-biblioref">2012</a>)</span> (see also Module 2 and Extra Reading material from that module). A <code>cutoff</code> argument can be further included to visualise correlation coefficients above this threshold in the multi-omics signature (Figure <a href="id_06.html#fig:06-circos-plot">6.6</a>). The colours for the blocks and correlation lines can be chosen with <code>color.blocks</code> and <code>color.cor</code> respectively:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="id_06.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circosPlot</span>(diablo.tcga, <span class="at">cutoff =</span> <span class="fl">0.7</span>, <span class="at">line =</span> <span class="cn">TRUE</span>, </span>
<span id="cb163-2"><a href="id_06.html#cb163-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color.blocks =</span> <span class="fu">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</span>
<span id="cb163-3"><a href="id_06.html#cb163-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color.cor =</span> <span class="fu">c</span>(<span class="st">&quot;chocolate3&quot;</span>,<span class="st">&quot;grey20&quot;</span>), <span class="at">size.labels =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-circos-plot"></span>
<img src="Figures/N-Integration/06-circos-plot-1.png" alt="Circos plot from multiblock sPLS-DA performed on the breast.TCGA study. The plot represents the correlations greater than 0.7 between variables of different types, represented on the side quadrants. The internal connecting lines show the positive (negative) correlations. The outer lines show the expression levels of each variable in each sample group (Basal, Her2 and LumA)." width="70%" />
<p class="caption">
Figure 6.6: <strong>Circos plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The plot represents the correlations greater than 0.7 between variables of different types, represented on the side quadrants. The internal connecting lines show the <span style="color: black;">positive</span> (<span style="color: #585858;">negative</span>) correlations. The outer lines show the expression levels of each variable in each sample group (<span style="color: #388ECC;">Basal</span>, <span style="color: #F68B33;">Her2</span> and <span style="color: #585858;">LumA</span>).
</p>
</div>

<p>The circos plot enables us to visualise cross-correlations between data types, and the nature of these correlations (<span style="color: black;">positive</span> or negative). Here we observe that correlations &gt; 0.7 are between a few <span style="color: black;">mRNA</span>and some <span style="color: #009E73;">Proteins</span>, whereas the majority of strong (negative) correlations are observed between <span style="color: #CC0000;">miRNA</span> and <span style="color: black;">mRNA</span>or <span style="color: #009E73;">Proteins</span>. The lines indicating the average expression levels per breast cancer subtype indicate that the selected features are able to discriminate the sample groups.</p>
</div>
<div id="network" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> <code>network</code><a href="id_06.html#network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Relevance networks, which are also built on the similarity matrix, can also visualise the correlations between the different types of variables. Each colour represents a type of variable. A threshold can also be set using the argument <code>cutoff</code> (Figure <a href="id_06.html#fig:06-network">6.7</a>). By default the network includes only variables selected on component 1, unless specified in <code>comp</code>.</p>
<p>Note that sometimes the output may not show with Rstudio due to margin issues. We can either use <code>X11()</code> to open a new window, or save the plot as an image using the arguments <code>save</code> and <code>name.save</code>, as we show below. An <code>interactive</code> argument is also available for the <code>cutoff</code> argument, see details in <code>?network</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="id_06.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X11()   # Opens a new window</span></span>
<span id="cb164-2"><a href="id_06.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">network</span>(diablo.tcga, <span class="at">blocks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb164-3"><a href="id_06.html#cb164-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">cutoff =</span> <span class="fl">0.4</span>,</span>
<span id="cb164-4"><a href="id_06.html#cb164-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color.node =</span> <span class="fu">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</span>
<span id="cb164-5"><a href="id_06.html#cb164-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># To save the plot, uncomment below line</span></span>
<span id="cb164-6"><a href="id_06.html#cb164-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">#save = &#39;png&#39;, name.save = &#39;diablo-network&#39;</span></span>
<span id="cb164-7"><a href="id_06.html#cb164-7" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-network"></span>
<img src="Figures/N-Integration/06-network-1.png" alt="Relevance network for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. Each node represents a selected variable with colours indicating their type. The colour of the edges represent positive or negative correlations. Further tweaking of this plot can be obtained, see the help file ?network." width="70%" />
<p class="caption">
Figure 6.7: <strong>Relevance network for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> Each node represents a selected variable with colours indicating their type. The colour of the edges represent positive or negative correlations. Further tweaking of this plot can be obtained, see the help file <code>?network</code>.
</p>
</div>

<p>The relevance network in Figure <a href="id_06.html#fig:06-network">6.7</a> shows two groups of features of different types. Within each group we observe positive and negative correlations. The visualisation of this plot could be further improved by changing the names of the original features.</p>
<p>Note that the network can be saved in a .gml format to be input into the software Cytoscape, using the R package <code>igraph</code> <span class="citation">(<a href="references.html#ref-csa06" role="doc-biblioref">Csardi, Nepusz, et al. 2006</a>)</span>:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="id_06.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not run</span></span>
<span id="cb165-2"><a href="id_06.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb165-3"><a href="id_06.html#cb165-3" aria-hidden="true" tabindex="-1"></a>myNetwork <span class="ot">&lt;-</span> <span class="fu">network</span>(diablo.tcga, <span class="at">blocks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span>
<span id="cb165-4"><a href="id_06.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.graph</span>(myNetwork<span class="sc">$</span>gR, <span class="at">file =</span> <span class="st">&quot;myNetwork.gml&quot;</span>, <span class="at">format =</span> <span class="st">&quot;gml&quot;</span>)</span></code></pre></div>
</div>
<div id="plotloadings" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> <code>plotLoadings</code><a href="id_06.html#plotloadings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>plotLoadings()</code> visualises the loading weights of each selected variable on each component and each data set. The colour indicates the class in which the variable has the maximum level of expression (<code>contrib = 'max'</code>) or minimum (<code>contrib = 'min'</code>), on average (<code>method = 'mean'</code>) or using the median (<code>method = 'median'</code>).</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="id_06.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotLoadings</span>(diablo.tcga, <span class="at">comp =</span> <span class="dv">1</span>, <span class="at">contrib =</span> <span class="st">&#39;max&#39;</span>, <span class="at">method =</span> <span class="st">&#39;median&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-loading-plot"></span>
<img src="Figures/N-Integration/06-loading-plot-1.png" alt="Loading plot for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. The most important variables (according to the absolute value of their coefficients) are ordered from bottom to top. As this is a supervised analysis, colours indicate the class for which the median expression value is the highest for each feature (variables selected characterise Basal and LumA)." width="70%" />
<p class="caption">
Figure 6.8: <strong>Loading plot for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> The most important variables (according to the absolute value of their coefficients) are ordered from bottom to top. As this is a supervised analysis, colours indicate the class for which the median expression value is the highest for each feature (variables selected characterise <span style="color: #388ECC;">Basal</span> and <span style="color: #585858;">LumA</span>).
</p>
</div>

<p>The loading plot shows the multi-omics signature selected on component 1, where each panel represents one data type. The importance of each variable is visualised by the length of the bar (i.e. its loading coefficient value). The combination of the sign of the coefficient (positive / negative) and the colours indicate that component 1 discriminates primarily the <span style="color: #388ECC;">Basal</span> samples vs. the <span style="color: #585858;">LumA</span> samples (see the sample plots also). The features selected are highly expressed in one of these two subtypes. One could also plot the second component that discriminates the <span style="color: #F68B33;">Her2</span> samples.</p>
</div>
<div id="cimdiablo" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> <code>cimDiablo</code><a href="id_06.html#cimdiablo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cimDiablo()</code> function is a clustered image map specifically implemented to represent the multi-omics molecular signature expression for each sample. It is very similar to a classical hierarchical clustering (Figure <a href="id_06.html#fig:06-cim">6.9</a>).</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="id_06.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cimDiablo</span>(diablo.tcga, <span class="at">color.blocks =</span> <span class="fu">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</span>
<span id="cb167-2"><a href="id_06.html#cb167-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">comp =</span> <span class="dv">1</span>, <span class="at">margin=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">20</span>), <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<pre><code>## 
## trimming values to [-3, 3] range for cim visualisation. See &#39;trim&#39; arg in ?cimDiablo</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-cim"></span>
<img src="Figures/N-Integration/06-cim-1.png" alt="Clustered Image Map for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. By default, Euclidean distance and Complete linkage methods are used. The CIM represents samples in rows (indicated by their breast cancer subtype on the left hand side of the plot) and selected features in columns (indicated by their data type at the top of the plot)." width="70%" />
<p class="caption">
Figure 6.9: <strong>Clustered Image Map for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> By default, Euclidean distance and Complete linkage methods are used. The CIM represents samples in rows (indicated by their breast cancer subtype on the left hand side of the plot) and selected features in columns (indicated by their data type at the top of the plot).
</p>
</div>

<p>According to the CIM, component 1 seems to primarily classify the <span style="color: #388ECC;">Basal</span> samples, with a group of overexpressed <span style="color: black;">miRNA</span> and underexpressed <span style="color: black;">mRNA</span>and <span style="color: black;">proteins</span>. A group of <span style="color: #585858;">LumA</span> samples can also be identified due to the overexpression of the same <span style="color: black;">mRNA</span>and <span style="color: black;">proteins</span>. <span style="color: #F68B33;">Her2</span> samples remain quite mixed with the other <span style="color: #585858;">LumA</span> samples.</p>
</div>
</div>
<div id="id_06:diablo-perf" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Model performance and prediction<a href="id_06.html#id_06:diablo-perf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We assess the performance of the model using 10-fold cross-validation repeated 10 times with the function <code>perf()</code>. The method runs a <code>block.splsda()</code> model on the pre-specified arguments input from our final object <code>diablo.tcga</code> but on cross-validated samples. We then assess the accuracy of the prediction on the left out samples. Since the <code>tune()</code> function was used with the <code>centroid.dist</code> argument, we examine the outputs of the <code>perf()</code> function for that same distance:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="id_06.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility with this handbook, remove otherwise</span></span>
<span id="cb169-2"><a href="id_06.html#cb169-2" aria-hidden="true" tabindex="-1"></a>perf.diablo.tcga <span class="ot">&lt;-</span> <span class="fu">perf</span>(diablo.tcga,  <span class="at">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="at">folds =</span> <span class="dv">10</span>, </span>
<span id="cb169-3"><a href="id_06.html#cb169-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrepeat =</span> <span class="dv">10</span>, <span class="at">dist =</span> <span class="st">&#39;centroids.dist&#39;</span>)</span>
<span id="cb169-4"><a href="id_06.html#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="id_06.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co">#perf.diablo.tcga  # Lists the different outputs</span></span></code></pre></div>
<p>We can extract the (balanced) classification error rates globally or overall with
<code>perf.diablo.tcga$error.rate.per.class</code>, the predicted components associated to <span class="math inline">\(\boldsymbol Y\)</span>, or the stability of the selected features with <code>perf.diablo.tcga$features</code>.</p>
<p>Here we look at the different performance assessment schemes specific to multiple data set integration.</p>
<p>First, we output the performance with the majority vote, that is, since the prediction is based on the components associated to their own data set, we can then weight those predictions across data sets according to a majority vote scheme. Based on the predicted classes, we then extract the classification error rate per class and per component:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="id_06.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance with Majority vote</span></span>
<span id="cb170-2"><a href="id_06.html#cb170-2" aria-hidden="true" tabindex="-1"></a>perf.diablo.tcga<span class="sc">$</span>MajorityVote.error.rate</span></code></pre></div>
<pre><code>## $centroids.dist
##                  comp1      comp2
## Basal       0.02666667 0.04444444
## Her2        0.20666667 0.12333333
## LumA        0.04533333 0.00800000
## Overall.ER  0.07200000 0.04200000
## Overall.BER 0.09288889 0.05859259</code></pre>
<p>The output shows that with the exception of the Basal samples, the classification improves with the addition of the second component.</p>
<p>Another prediction scheme is to weight the classification error rate from each data set according to the correlation between the predicted components and the <span class="math inline">\(\boldsymbol Y\)</span> outcome.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="id_06.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance with Weighted vote</span></span>
<span id="cb172-2"><a href="id_06.html#cb172-2" aria-hidden="true" tabindex="-1"></a>perf.diablo.tcga<span class="sc">$</span>WeightedVote.error.rate</span></code></pre></div>
<pre><code>## $centroids.dist
##                   comp1      comp2
## Basal       0.006666667 0.04444444
## Her2        0.140000000 0.10666667
## LumA        0.045333333 0.00800000
## Overall.ER  0.052666667 0.03866667
## Overall.BER 0.064000000 0.05303704</code></pre>
<p>Compared to the previous majority vote output, we can see that the classification accuracy is slightly better on component 2 for the subtype Her2.</p>
<p>An AUC plot <em>per block</em> is plotted using the function <code>auroc()</code>. We have already mentioned in Module 3 for PLS-DA, the interpretation of this output may not be particularly insightful in relation to the performance evaluation of our methods, but can complement the statistical analysis. For example, here for the miRNA data set once we have reached component 2 (Figure <a href="id_06.html#fig:06-auroc">6.10</a>):</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="id_06.html#cb174-1" aria-hidden="true" tabindex="-1"></a>auc.diablo.tcga <span class="ot">&lt;-</span> <span class="fu">auroc</span>(diablo.tcga, <span class="at">roc.block =</span> <span class="st">&quot;miRNA&quot;</span>, <span class="at">roc.comp =</span> <span class="dv">2</span>,</span>
<span id="cb174-2"><a href="id_06.html#cb174-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">print =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:06-auroc"></span>
<img src="Figures/N-Integration/06-auroc-1.png" alt="ROC and AUC based on multiblock sPLS-DA performed on the breast.TCGA study for the miRNA data set after 2 components. The function calculates the ROC curve and AUC for one class vs. the others. If we set print = TRUE, the Wilcoxon test p-value that assesses the differences between the predicted components from one class vs. the others is output." width="70%" />
<p class="caption">
Figure 6.10: <strong>ROC and AUC based on multiblock sPLS-DA performed on the <code>breast.TCGA</code> study for the miRNA data set after 2 components.</strong> The function calculates the ROC curve and AUC for one class vs. the others. If we set <code>print = TRUE</code>, the Wilcoxon test p-value that assesses the differences between the predicted components from one class vs. the others is output.
</p>
</div>

<p>Figure <a href="id_06.html#fig:06-auroc">6.10</a> shows that the Her2 subtype is the most difficult to classify with multiblock sPLS-DA compared to the other subtypes.</p>
<p>The <code>predict()</code> function associated with a <code>block.splsda()</code> object predicts the class of samples from an external test set. In our specific case, one data set is missing in the test set but the method can still be applied. We need to ensure the names of the blocks correspond exactly to those from the training set:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="id_06.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare test set data: here one block (proteins) is missing</span></span>
<span id="cb175-2"><a href="id_06.html#cb175-2" aria-hidden="true" tabindex="-1"></a>data.test.tcga <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mRNA =</span> breast.TCGA<span class="sc">$</span>data.test<span class="sc">$</span>mrna, </span>
<span id="cb175-3"><a href="id_06.html#cb175-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">miRNA =</span> breast.TCGA<span class="sc">$</span>data.test<span class="sc">$</span>mirna)</span>
<span id="cb175-4"><a href="id_06.html#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="id_06.html#cb175-5" aria-hidden="true" tabindex="-1"></a>predict.diablo.tcga <span class="ot">&lt;-</span> <span class="fu">predict</span>(diablo.tcga, <span class="at">newdata =</span> data.test.tcga)</span>
<span id="cb175-6"><a href="id_06.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The warning message will inform us that one block is missing</span></span>
<span id="cb175-7"><a href="id_06.html#cb175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-8"><a href="id_06.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="co">#predict.diablo # List the different outputs</span></span></code></pre></div>
<p>The following output is a confusion matrix that compares the real subtypes with the predicted subtypes for a 2 component model, for the distance of interest <code>centroids.dist</code> and the prediction scheme <code>WeightedVote</code>:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="id_06.html#cb176-1" aria-hidden="true" tabindex="-1"></a>confusion.mat.tcga <span class="ot">&lt;-</span> <span class="fu">get.confusion_matrix</span>(<span class="at">truth =</span> breast.TCGA<span class="sc">$</span>data.test<span class="sc">$</span>subtype, </span>
<span id="cb176-2"><a href="id_06.html#cb176-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">predicted =</span> predict.diablo.tcga<span class="sc">$</span>WeightedVote<span class="sc">$</span>centroids.dist[,<span class="dv">2</span>])</span>
<span id="cb176-3"><a href="id_06.html#cb176-3" aria-hidden="true" tabindex="-1"></a>confusion.mat.tcga</span></code></pre></div>
<pre><code>##       predicted.as.Basal predicted.as.Her2 predicted.as.LumA
## Basal                 20                 1                 0
## Her2                   0                13                 1
## LumA                   0                 3                32</code></pre>
<p>From this table, we see that one Basal and one Her2 sample are wrongly predicted as Her2 and Lum A respectively, and 3 LumA samples are wrongly predicted as Her2. The balanced prediction error rate can be obtained as:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="id_06.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get.BER</span>(confusion.mat.tcga)</span></code></pre></div>
<pre><code>## [1] 0.06825397</code></pre>
<p>It would be worthwhile at this stage to revisit the chosen design of the multiblock sPLS-DA model to assess the influence of the design on the prediction performance on this test set - even though this back and forth analysis is a biased criterion to choose the design!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_05.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_07.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-Nintegration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["mixOmics Vignette.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
